Running: LatentAdditive_GET_celltypeaware_genelevel-GATEDCT
Loaded AnnData: AnnData object with n_obs × n_vars = 21700 × 5000
    obs: 'orig.ident', 'nCount_RNA', 'nFeature_RNA', 'seurat_clusters', 'Assign', 'scds', 'cxds', 'bcds', 'Sample', 'nCount_refAssay', 'nFeature_refAssay', 'predicted.subclass.score', 'predicted.subclass', 'CT', 'mito', 'BioSamp', 'CT2', 'ForPlot', 'Remove', 'active_ident', 'Assign_clean', 'condition', 'cell_type', 'cell_class', 'celltype_mapped'
    var: 'variable_gene', 'gene_name', 'highly_variable', 'means', 'dispersions', 'dispersions_norm'
    uns: 'ATAC_embeddings', 'GET_embeddings', 'hvg', 'log1p'
Split counts:
 split
train    16070
test      3033
val       2597
Name: count, dtype: int64
Train=16070 | Val=2597 | Test=3033
Pert dim: 12
Cov dim: 4
GET tensor loaded: torch.Size([15, 5000, 768])
DataLoaders ready.
Using: cuda
Epoch 01 | train=0.069010 | val=0.049709 | lr=1.00e-04
Epoch 02 | train=0.048429 | val=0.044657 | lr=1.00e-04
Epoch 03 | train=0.044424 | val=0.041491 | lr=1.00e-04
Epoch 04 | train=0.041930 | val=0.039954 | lr=1.00e-04
Epoch 05 | train=0.040594 | val=0.039094 | lr=1.00e-04
Epoch 06 | train=0.039667 | val=0.038537 | lr=1.00e-04
Epoch 07 | train=0.038989 | val=0.038115 | lr=1.00e-04
Epoch 08 | train=0.038463 | val=0.037757 | lr=1.00e-04
Epoch 09 | train=0.037988 | val=0.037485 | lr=1.00e-04
Epoch 10 | train=0.037624 | val=0.037325 | lr=1.00e-04
Epoch 11 | train=0.037296 | val=0.037087 | lr=1.00e-04
Epoch 12 | train=0.037003 | val=0.036999 | lr=1.00e-04
Epoch 13 | train=0.036713 | val=0.036906 | lr=1.00e-04
Epoch 14 | train=0.036433 | val=0.036767 | lr=1.00e-04
Epoch 15 | train=0.036179 | val=0.036636 | lr=1.00e-04
Epoch 16 | train=0.035928 | val=0.036572 | lr=1.00e-04
Epoch 17 | train=0.035702 | val=0.036527 | lr=1.00e-04
Epoch 18 | train=0.035442 | val=0.036412 | lr=1.00e-04
Epoch 19 | train=0.035206 | val=0.036325 | lr=1.00e-04
Epoch 20 | train=0.034983 | val=0.036321 | lr=1.00e-04
Training complete.
==== FINAL RESULTS ====
{'global': {'rmse': 0.1941543957989966, 'pearson_mean': 0.855525793873289, 'cosine_mean': 0.8642565016072609}, 'per_pert': {'BCL11B': {'n_cells': 1380, 'logfc_corr': 0.9366300793536388, 'top50_recall': 0.76}, 'XPO7': {'n_cells': 392, 'logfc_corr': 0.9617833362232485, 'top50_recall': 0.82}, 'TBR1': {'n_cells': 607, 'logfc_corr': 0.9896531499920022, 'top50_recall': 0.92}, 'CX3CL1': {'n_cells': 183, 'logfc_corr': 0.9846873487455889, 'top50_recall': 0.9}, 'HERC1': {'n_cells': 162, 'logfc_corr': 0.9813426327877596, 'top50_recall': 0.82}, 'ctrl': {'n_cells': 309, 'logfc_corr': 0.9186823148668661, 'top50_recall': 0.72}}}

Learned alpha per celltype:
astro-epen          : 0.6931
cnu-mge_gaba        : 0.6931
cr_glut             : 0.6764
ctx-cge_gaba        : 0.6931
ctx-mge_gaba        : 0.6746
glioblast           : 0.6931
immune              : 0.6931
imn                 : 0.6931
ip                  : 0.6931
it_glut             : 0.6841
nec                 : 0.6931
nonit_glut          : 0.6540
opc-oligo           : 0.6931
rg                  : 0.6931
vascular            : 0.6931
===== END =====
Time: Fri Nov 21 16:43:37 PST 2025
