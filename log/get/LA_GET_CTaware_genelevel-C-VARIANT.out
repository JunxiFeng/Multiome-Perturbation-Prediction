Running: LatentAdditive_GET_celltypeaware_genelevel-C-VARIANT
Loaded AnnData: AnnData object with n_obs × n_vars = 21700 × 5000
    obs: 'orig.ident', 'nCount_RNA', 'nFeature_RNA', 'seurat_clusters', 'Assign', 'scds', 'cxds', 'bcds', 'Sample', 'nCount_refAssay', 'nFeature_refAssay', 'predicted.subclass.score', 'predicted.subclass', 'CT', 'mito', 'BioSamp', 'CT2', 'ForPlot', 'Remove', 'active_ident', 'Assign_clean', 'condition', 'cell_type', 'cell_class', 'celltype_mapped'
    var: 'variable_gene', 'gene_name', 'highly_variable', 'means', 'dispersions', 'dispersions_norm'
    uns: 'ATAC_embeddings', 'GET_embeddings', 'hvg', 'log1p'
Split counts:
 split
train    16070
test      3033
val       2597
Name: count, dtype: int64
Train=16070 | Val=2597 | Test=3033
Pert dim: 12
Cov dims: 4
GET tensor: torch.Size([15, 5000, 768])
DataLoaders ready.
Using: cuda
Epoch 01 | train=0.069098 | val=0.049928
Epoch 02 | train=0.048569 | val=0.044882
Epoch 03 | train=0.044851 | val=0.042124
Epoch 04 | train=0.042416 | val=0.040373
Epoch 05 | train=0.040947 | val=0.039494
Epoch 06 | train=0.039985 | val=0.038843
Epoch 07 | train=0.039274 | val=0.038441
Epoch 08 | train=0.038733 | val=0.038025
Epoch 09 | train=0.038279 | val=0.037751
Epoch 10 | train=0.037894 | val=0.037461
Epoch 11 | train=0.037537 | val=0.037294
Epoch 12 | train=0.037254 | val=0.037176
Epoch 13 | train=0.036972 | val=0.037044
Epoch 14 | train=0.036703 | val=0.036957
Epoch 15 | train=0.036462 | val=0.036797
Epoch 16 | train=0.036225 | val=0.036732
Epoch 17 | train=0.035969 | val=0.036652
Epoch 18 | train=0.035748 | val=0.036633
Epoch 19 | train=0.035521 | val=0.036543
Epoch 20 | train=0.035294 | val=0.036526
Training finished.
{'global': {'rmse': 0.1946242699881983, 'pearson_mean': 0.854743617985924, 'cosine_mean': 0.863527394122907}, 'per_pert': {'BCL11B': {'n_cells': 1380, 'logfc_corr': 0.9358753234583708, 'top50_recall': 0.74}, 'XPO7': {'n_cells': 392, 'logfc_corr': 0.9588237669261499, 'top50_recall': 0.84}, 'TBR1': {'n_cells': 607, 'logfc_corr': 0.9878454904874093, 'top50_recall': 0.9}, 'CX3CL1': {'n_cells': 183, 'logfc_corr': 0.982608498824064, 'top50_recall': 0.94}, 'HERC1': {'n_cells': 162, 'logfc_corr': 0.9821586515793382, 'top50_recall': 0.88}, 'ctrl': {'n_cells': 309, 'logfc_corr': 0.912544823411415, 'top50_recall': 0.72}}}
===== END =====
Time: Fri Nov 21 15:31:57 PST 2025
