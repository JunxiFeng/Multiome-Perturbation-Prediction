Running: LatentAdditive_GET_celltypeaware_genelevel
Loaded AnnData: AnnData object with n_obs × n_vars = 21700 × 5000
    obs: 'orig.ident', 'nCount_RNA', 'nFeature_RNA', 'seurat_clusters', 'Assign', 'scds', 'cxds', 'bcds', 'Sample', 'nCount_refAssay', 'nFeature_refAssay', 'predicted.subclass.score', 'predicted.subclass', 'CT', 'mito', 'BioSamp', 'CT2', 'ForPlot', 'Remove', 'active_ident', 'Assign_clean', 'condition', 'cell_type', 'cell_class', 'celltype_mapped'
    var: 'variable_gene', 'gene_name', 'highly_variable', 'means', 'dispersions', 'dispersions_norm'
    uns: 'ATAC_embeddings', 'GET_embeddings', 'hvg', 'log1p'
Split counts:
 split
train    16070
test      3033
val       2597
Name: count, dtype: int64
Train: 16070 | Val: 2597 | Test: 3033
Pert dim: 12
Cov dim: 4
Loaded GET as CT-level tensor: torch.Size([15, 5000, 768])
DataLoaders ready.
cuda
Epoch 01 | train=0.073823 | val=0.060975
Epoch 02 | train=0.056492 | val=0.051426
Epoch 03 | train=0.051473 | val=0.049913
Epoch 04 | train=0.050110 | val=0.049025
Epoch 05 | train=0.049075 | val=0.048727
Epoch 06 | train=0.048264 | val=0.047288
Epoch 07 | train=0.047404 | val=0.046481
Epoch 08 | train=0.046520 | val=0.045888
Epoch 09 | train=0.045918 | val=0.045167
Epoch 10 | train=0.045453 | val=0.044713
Epoch 11 | train=0.045083 | val=0.044415
Epoch 12 | train=0.044776 | val=0.044229
Epoch 13 | train=0.044579 | val=0.044221
Epoch 14 | train=0.044357 | val=0.043949
Epoch 15 | train=0.044127 | val=0.043767
Epoch 16 | train=0.043913 | val=0.043421
Epoch 17 | train=0.043571 | val=0.042966
Epoch 18 | train=0.043133 | val=0.042612
Epoch 19 | train=0.042711 | val=0.042212
Epoch 20 | train=0.042319 | val=0.041891
Training complete.
{'global': {'rmse': 0.20811253808203523, 'pearson_mean': 0.8320255219370056, 'cosine_mean': 0.8423217299186597}, 'per_pert': {'BCL11B': {'n_cells': 1380, 'logfc_corr': 0.8682557517850112, 'top50_recall': 0.64}, 'XPO7': {'n_cells': 392, 'logfc_corr': 0.9368610377065155, 'top50_recall': 0.82}, 'TBR1': {'n_cells': 607, 'logfc_corr': 0.9864212323084118, 'top50_recall': 0.92}, 'CX3CL1': {'n_cells': 183, 'logfc_corr': 0.9794168508450645, 'top50_recall': 0.9}, 'HERC1': {'n_cells': 162, 'logfc_corr': 0.9777476927676079, 'top50_recall': 0.88}, 'ctrl': {'n_cells': 309, 'logfc_corr': 0.7853357665924976, 'top50_recall': 0.54}}}
===== END =====
Time: Fri Nov 21 14:07:03 PST 2025
