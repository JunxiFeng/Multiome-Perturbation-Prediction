Running: LatentAdditive_GET_celltypeaware_ATTENTION
Loaded AnnData: AnnData object with n_obs × n_vars = 21700 × 5000
    obs: 'orig.ident', 'nCount_RNA', 'nFeature_RNA', 'seurat_clusters', 'Assign', 'scds', 'cxds', 'bcds', 'Sample', 'nCount_refAssay', 'nFeature_refAssay', 'predicted.subclass.score', 'predicted.subclass', 'CT', 'mito', 'BioSamp', 'CT2', 'ForPlot', 'Remove', 'active_ident', 'Assign_clean', 'condition', 'cell_type', 'cell_class', 'celltype_mapped'
    var: 'variable_gene', 'gene_name', 'highly_variable', 'means', 'dispersions', 'dispersions_norm'
    uns: 'ATAC_embeddings', 'GET_embeddings', 'hvg', 'log1p'
Split counts:
 split
train    16070
test      3033
val       2597
Name: count, dtype: int64
Train=16070 | Val=2597 | Test=3033
Pert dim: 12
Cov dims: 4
GET tensor: torch.Size([15, 5000, 768])
DataLoaders ready.
Using: cuda
Epoch 01 | train=0.074551 | val=0.050457
Epoch 02 | train=0.048370 | val=0.044228
Epoch 03 | train=0.043978 | val=0.040974
Epoch 04 | train=0.041679 | val=0.039556
Epoch 05 | train=0.040401 | val=0.038799
Epoch 06 | train=0.039569 | val=0.038284
Epoch 07 | train=0.038965 | val=0.037887
Epoch 08 | train=0.038489 | val=0.037599
Epoch 09 | train=0.038087 | val=0.037400
Epoch 10 | train=0.037724 | val=0.037059
Epoch 11 | train=0.037383 | val=0.036921
Epoch 12 | train=0.037090 | val=0.036784
Epoch 13 | train=0.036810 | val=0.036577
Epoch 14 | train=0.036548 | val=0.036501
Epoch 15 | train=0.036300 | val=0.036409
Epoch 16 | train=0.036072 | val=0.036325
Epoch 17 | train=0.035848 | val=0.036162
Epoch 18 | train=0.035628 | val=0.036211
Epoch 19 | train=0.035412 | val=0.036042
Epoch 20 | train=0.035215 | val=0.035956
Training finished.
==== FINAL RESULTS ====
{'global': {'rmse': 0.19311799289744222, 'pearson_mean': 0.8572271333104804, 'cosine_mean': 0.8658457913051522, 'global_logfc_cosine': 0.882085301149267}, 'per_pert': {'BCL11B': {'n_cells': 1380, 'logfc_corr': 0.9486757522610416, 'logfc_cosine': 0.9504766106142584, 'top50_recall': 0.76}, 'XPO7': {'n_cells': 392, 'logfc_corr': 0.9533890804677876, 'logfc_cosine': 0.9553465143063826, 'top50_recall': 0.72}, 'TBR1': {'n_cells': 607, 'logfc_corr': 0.9489970550289176, 'logfc_cosine': 0.9494629493939041, 'top50_recall': 0.8}, 'CX3CL1': {'n_cells': 183, 'logfc_corr': 0.937405015827341, 'logfc_cosine': 0.9376365514589632, 'top50_recall': 0.76}, 'HERC1': {'n_cells': 162, 'logfc_corr': 0.9430535123760305, 'logfc_cosine': 0.9431983594744512, 'top50_recall': 0.86}}}
===== END =====
Time: Mon Nov 24 12:26:28 PST 2025
